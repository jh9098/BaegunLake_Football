import { useEffect } from "react";
import { useNavigate, useSearchParams } from "react-router-dom";
import axios from "axios";
// import { useClub } from "../app/store";

export default function KakaoCallback() {
  const navigate = useNavigate();
  const [params] = useSearchParams();
  // const { setUser } = useClub(); // 필요 시

  useEffect(() => {
    const code = params.get("code");
    if (!code) return;
    (async () => {
      try {
        const { data } = await axios.post("/api/auth/kakao", { code });
        localStorage.setItem("token", data.token);
        // setUser(data.user);
        navigate("/dashboard");
      } catch (e) {
        console.error(e);
        navigate("/");
      }
    })();
  }, []);

  return <p className="p-4">로그인 중…</p>;
}
